<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../current_order/current_order.css"/>  
    <script src="./current_order.js"></script>
    <title>Request an Assistant</title>
    <script>
        function getCookie(cname)
        {
            var name = cname + "=";
            var ca = document.cookie.split(';');
            for(var i=0; i<ca.length; i++)
            {
                var c = ca[i].trim();
                if (c.indexOf(name)==0) return c.substring(name.length,c.length);
            }
            return "";
        }
        window.onload = function() {
            var curorder_id = getCookie("oid");
            alert(curorder_id);
            const req = new XMLHttpRequest();
            req.open("POST", "current_order", true);
            req.setRequestHeader('Content-Type', 'application/json');
            var jsonObj = new Object();
            jsonObj.oid = curorder_id;
            console.log(curorder_id);
            req.send(JSON.stringify(jsonObj));
            req.onreadystatechange = function() {
                if (req.readyState === 4) {
                    console.log(req.response);
                    const json = JSON.parse(req.response);
                    document.getElementById("orderId").innerHTML=json.cur_orderid;
                    document.getElementById("cusID").innerHTML=json.O_cusNum;
                    document.getElementById("vehicle").innerHTML=json.vehiclePlate;
                    document.getElementById("issue").innerHTML=json.issue;
                    document.getElementById("sstate").innerHTML=json.sstate;
                    document.getElementById("orderStartDate").innerHTML=json.orderStartDate;
                    document.getElementById("price").innerHTML=json.price;
                }
            }
        }
    </script>
    <script src="current_order.js"></script>
</head>
<body>
    <div id="header">
        <h1>
            Request an Assistant
        </h1>
    </div>
    <div>
        <div>Order ID: </div>
        <span id = "orderId"></span>

    </div>
    <div>
        <div>Customer ID: </div>
        <span id = "cusID"></span>

    </div>
    <div>
        <div>Vehicle: </div>
        <span id = "vehicle"></span>
    </div>
    <div>
        <div>Issue: </div>
        <span id = "issue"></span>
    </div>
    <div>
        <div>Service state</div>
        <span id = "sstate"></span>
    </div>
    <div>
        <div>Service Date</div>
        <span id = "orderStartDate"></span>
    </div>
    <div>
        <div>Price</div>
        <span id = "price"></span>
    </div>
    <div>
        <button onclick="refreshBtn()">Refresh</button>
    </div>
    <table style="width: 100%;">
        <table style="width: 50%;">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3291.0801341075103!2d150.89169511616595!3d-34.42471958050633!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6b1319a5c5b704fb%3A0x3f038f4f50910d82!2sWollongong%20Central!5e0!3m2!1szh-CN!2sau!4v1648952144074!5m2!1szh-CN!2sau" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        </table>
        <button style="display: block" onclick="payBtn()" id="pay"> Pay!</button>
        <button onclick="back()">Back</button>

    </table>
    
</body>
</html>